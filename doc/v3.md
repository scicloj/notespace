## Version 3

At the moment, Version 3 is used for documentation at [scicloj.ml](github.com/scicloj/scicloj.ml), at the [scicloj-data-science-handbook](github.com/scicloj/scicloj-data-science-handbook) draft, and at various

### Usage

See [the tutorial](https://scicloj.github.io/notespace/doc/notespace/v3-experiment1-test/index.html), that was generated by [this namespace](./test/notespace/v3_experiment1_test.clj).

[2021-08-19 screencast](https://www.youtube.com/watch?v=Ufyqwzn1RDs)

[A recorded study meeting from March 2nd, 2021](https://www.youtube.com/watch?v=2tGk1Jh7dJs)

[2020-08-24 screencast](https://youtu.be/_GcTnkhn9g0) (a bit outdated)

#### Editor-agnostic workflow
You can use Notespace alongside with any editor or IDE by listening to file save events (needs to be dodumented better).

#### Editor integration
You can have tighter integration with your editor, using the main API functions.

See [emacs-config.el](./emacs-config.el) as a recommended way to do it. We wish to offer similar solutions in other editors and IDEs.

### Background

The creation of version 3 has followed some ideas from our discussions of [alternative notation](https://clojurians.zulipchat.com/#narrow/stream/224153-notespace-dev/topic/alternative.20notation) and of [evaluation semantics](https://clojurians.zulipchat.com/#narrow/stream/224153-notespace-dev/topic/evaluation.20semantics.20--.20suggested.20breaking.20change).

Several people's ideas and comments have affected this version.
`@awb99` `@behrica` `@daslu` `@ezmiller` `@genmeblog` `@jsa-aerial` `@metasoarous` `@nickstares` `@vlaaad` `@mchampine`

### Main changes
Here are the main thingss that are changing here, comparing to Version 2:
* Version 3 offers a different notion of what notespaces and notes are. Arguably, this notion is less strange to the usual Clojure concepts and idioms.
* Very little extra notation is necessary, and it is just some tiny amount of metadata that determines how things should be rendered.
* A small set of API functions allows to evaluate code in a way that informs the browser notebook about changes.
* Time-related Clojure semantics such as futures and delays can be handled in a way that respects and informs the notebook too when values are realized.
* The new implementation makes things more flexible and easier to extend and experiment with.
* Data visualizations based on [gorilla-ui](https://github.com/pink-gorilla/gorilla-ui) Hiccup extensions are supported.

### Implementation
For state management and event handling at Clojure JVM, we use [cljfx](https://github.com/cljfx/cljfx)'s [state management logic](https://github.com/cljfx/cljfx#subscriptions-and-contexts). To avoid the dependency of JavaFX, we copied the relevant parts of cljfx under `notespace.cljfx.*`.

The current rendering engine is based on [gorilla-notes](https://github.com/scicloj/gorilla-notes), which is a thin wrapper of [gorilla-ui](https://github.com/pink-gorilla/gorilla-ui).

The client side stack is based on [shadow-cljs](https://github.com/thheller/shadow-cljs) and [reagent](https://reagent-project.github.io).

As with Version 2, we use [tools.reader](https://github.com/clojure/tools.reader) to read the code of the namespace.

#### Renderers

Rendering is now an abstract notion, and thus Notespace can be extended with different ways of rendering. At least one of them will create static-htmls, based on gorilla-notes. Other potential renderers may rely on [Oz](https://github.com/metasoarous/oz) or [rmarkdown-clojure](https://github.com/genmeblog/rmarkdown-clojure), or generate and update [Pink Gorilla](https://pink-gorilla.github.io) notebooks on the fly.

### Known issues
* Many of the notions, ideas and behaviours of Version 2 are not supported by Version 3 at the moment. Most of them are enabled in a different way. We need to discuss whether to create some backwards compatibility layer.
* Currently things tend to break when moving across several namespaces. For now, calling `(notespace.api/init)` is a good habit for such cases.

It follows some ideas from our discussions of [alternative notation](https://clojurians.zulipchat.com/#narrow/stream/224153-notespace-dev/topic/alternative.20notation) and of [evaluation semantics](https://clojurians.zulipchat.com/#narrow/stream/224153-notespace-dev/topic/evaluation.20semantics.20--.20suggested.20breaking.20change).

Several people's ideas and comments have affected this version.
`@awb99` `@behrica` `@daslu` `@ezmiller` `@genmeblog` `@jsa-aerial` `@metasoarous` `@nickstares` `@vlaaad` 

